{#
    A query to get count active apps on a chain

    Parameters:
    - days: default = 30; The time interval (in days) to consider for data extraction.
    - origin_keys: The origin_keys to filter the data.
#}

{% set days = days | default(30) %}


SELECT count(distinct owner_project) as active_apps
FROM public.vw_apps_contract_level_materialized
where origin_key IN ( '{{ origin_keys | join("', '") }}' )
    and date > current_date - interval '{{days}} days'